<!DOCTYPE html>
<html lang="en">
  <%- include('../components/head.ejs', {title: data.page_title}) %>
  <body>
    <svg width="0" height="0" class="hide">
      <symbol
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 16 16"
        id="calendar2-date"
      >
        <path
          d="M6.445 12.688V7.354h-.633A13 13 0 0 0 4.5 8.16v.695c.375-.257.969-.62 1.258-.777h.012v4.61zm1.188-1.305c.047.64.594 1.406 1.703 1.406 1.258 0 2-1.066 2-2.871 0-1.934-.781-2.668-1.953-2.668-.926 0-1.797.672-1.797 1.809 0 1.16.824 1.77 1.676 1.77.746 0 1.23-.376 1.383-.79h.027c-.004 1.316-.461 2.164-1.305 2.164-.664 0-1.008-.45-1.05-.82zm2.953-2.317c0 .696-.559 1.18-1.184 1.18-.601 0-1.144-.383-1.144-1.2 0-.823.582-1.21 1.168-1.21.633 0 1.16.398 1.16 1.23"
        ></path>
        <path
          d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"
        ></path>
        <path
          d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5z"
        ></path>
      </symbol>

      <symbol
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 16 16"
        id="pencil-fill"
      >
        <path
          d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z"
        ></path>
      </symbol>

      <symbol
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 16 16"
        id="trash-fill"
      >
        <path
          d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5m-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5M4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06m6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528M8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5"
        />
      </symbol>

      <symbol
        xmlns="http://www.w3.org/2000/svg"
        id="save-fill"
        viewBox="0 0 16 16"
      >
        <path
          d="M8.5 1.5A1.5 1.5 0 0 1 10 0h4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h6c-.314.418-.5.937-.5 1.5v7.793L4.854 6.646a.5.5 0 1 0-.708.708l3.5 3.5a.5.5 0 0 0 .708 0l3.5-3.5a.5.5 0 0 0-.708-.708L8.5 9.293z"
        />
      </symbol>
    </svg>
    <div id="root">
      <%- include('../components/pop-up.ejs') %>
      <div class="page-layout">
        <!-- prettier-ignore -->
        <%- include('../components/nav-section.ejs') %>

        <main
          class="page-layout__main page-layout__section main"
          id="js-section-main"
          data-message="<%= data.message %>"
        >
          <div><%= data.message %></div>
          <h2>
            <%= data.pageTitle %>
            <%= data.report.report.name %>
          </h2>
          <div>
            дата создания:
            <%= data.report.report.date.toLocaleDateString() %>
          </div>
          <div class="page-layout__wrapper">
            <form
              class="form form--vertical form--edit-option"
              method="post"
              accept-charset="utf-8"
              url="./"
            >
              <div
                class="form__body form__body--background form__body--disabled"
              >
                <label>
                  <div class="label-text">Название отчета</div>
                  <input
                    class="form-control"
                    type="text"
                    value="<%= data.report.report.name %>"
                    name="reportName"
                    disabled
                  />
                </label>
                <label>
                  <div class="label-text">Комментарий к отчету</div>
                  <!-- prettier-ignore -->
                  <textarea name="reportDescription" class="form-control form-control--textarea" disabled><%= data.report.report.description %></textarea>
                </label>
                <button
                  class="btn btn-outline-primary"
                  type="submit"
                  disabled
                  id="btn-save-report-data"
                >
                  Сохранить изменения
                </button>

                <button class="btn-reset btn-flow" type="button">
                  <svg class="sprite-icon">
                    <use xlink:href="#pencil-fill"></use>
                  </svg>
                </button>
              </div>
            </form>

            <table class="table">
              <thead>
                <tr>
                  <th>Пост</th>
                  <th>
                    <img
                      src="/img/bootstrap-icons/heart-fill.svg"
                      alt="Нравится"
                    />
                  </th>
                  <th>
                    <img
                      src="/img/bootstrap-icons/eye-fill.svg"
                      alt="Просмотры"
                    />
                  </th>
                  <th>
                    <img
                      src="/img/bootstrap-icons/chat-right-text-fill.svg"
                      alt="Количество комментариев"
                    />
                  </th>
                  <th></th>
                  <th></th>
                </tr>
              </thead>

              <tbody id="comment-list">
                <% data.report.commentList.forEach((item, index) => { %>
                <tr>
                  <td>
                    <div class="tech-info">
                      <div class="tech-info__item">
                        <svg class="sprite-icon">
                          <use xlink:href="#calendar2-date"></use>
                        </svg>
                        <%= new Date(item.post.post.date * 1000).toLocaleDateString() %>
                      </div>
                    </div>
                    <strong><%= item.groupName %></strong>
                    <div><%= item.post.post.text.slice(0, 200) %>...</div>
                  </td>
                  <td>
                    <%= item.post.post.likes?.count.toLocaleString() || 0 %>
                  </td>
                  <td>
                    <%= item.post.post.views?.count.toLocaleString() || 0 %>
                  </td>
                  <td>
                    <%= item.post.post.comments?.count.toLocaleString() || 0 %>
                  </td>

                  <td>
                    <!-- prettier-ignore -->
                    <textarea class="form-control form-control--textarea js-post-comment" data-btn-save-id="btn-save-post-comment-<%= item.commentId %>" ><%= item.commentText %></textarea>
                  </td>
                  <td>
                    <div class="flex">
                      <button
                        class="btn-reset btn-icon btn--danger js-btn-delete-comment"
                        type="button"
                        data-comment-id="<%= item.commentId %>"
                      >
                        <svg class="sprite-icon">
                          <use xlink:href="#trash-fill"></use>
                        </svg>
                      </button>
                      <button
                        class="btn-reset btn-icon btn--primary js-btn-save-comment"
                        type="button"
                        id="btn-save-post-comment-<%= item.commentId %>"
                        data-comment-id="<%= item.commentId %>"
                        disabled
                      >
                        <svg class="sprite-icon">
                          <use xlink:href="#save-fill"></use>
                        </svg>
                      </button>
                    </div>
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </main>
      </div>
    </div>
    <script async src="/js/fetch-data.js"></script>
    <script defer src="/js/utils/pop-up.js"></script>
    <script defer src="/js/form-edit-option.js"></script>
    <script defer src="/js/one-report-page.js"></script>
  </body>
</html>
